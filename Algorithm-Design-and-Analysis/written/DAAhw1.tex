\documentclass[12pt,letterpaper]{article}
\usepackage{fullpage}
\usepackage[top=2cm, bottom=4.5cm, left=2.5cm, right=2.5cm]{geometry}
\usepackage{amsmath,amsthm,amsfonts,amssymb,amscd}
\usepackage{lastpage}
\usepackage{enumerate}
\usepackage{fancyhdr}
\usepackage{mathrsfs}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{mathtools}
\usepackage{xfrac}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}

\hypersetup{%
  colorlinks=true,
  linkcolor=blue,
  linkbordercolor={0 0 1}
}
\linespread{1.1}
 
\renewcommand\lstlistingname{Algorithm}
\renewcommand\lstlistlistingname{Algorithms}
\def\lstlistingautorefname{Alg.}

\lstdefinestyle{Python}{
    language        = Python,
    frame           = lines, 
    basicstyle      = \footnotesize,
    keywordstyle    = \color{blue},
    stringstyle     = \color{green},
    commentstyle    = \color{red}\ttfamily
}

\setlength{\parindent}{0.0in}
\setlength{\parskip}{0.05in}

% Edit these as appropriate
\newcommand\course{Algorithms}
\newcommand\hwnumber{1}                  % <-- homework number
\newcommand\NetIDa{SUN Yilin}           % <-- NetID of person #1
\newcommand\NetIDb{520030910361}           % <-- NetID of person #2 (Comment this line out for problem sets)

\pagestyle{fancyplain}
\headheight 35pt
\lhead{\NetIDa}
\lhead{\NetIDa\\\NetIDb}                 % <-- Comment this line out for problem sets (make sure you are person #1)
\chead{\textbf{\Large Homework \hwnumber}}
\rhead{\course \\ \today}
\lfoot{}
\cfoot{}
\rfoot{\small\thepage}
\headsep 1.5em

\begin{document}

\section{}
Without loss of generality, assume $n=b^{2k}$ for some $k\in\mathbb{N}$, then 
\begin{align}
    T(n)&=aT(\frac{n}{b})+n^d\log^wn\\
    &=a(aT(\frac{n}{b^2})+(\frac{n}{b})^d\log^w(\frac{n}{b}))+n^d\log^wn\\
    &=a^2T(\frac{n}{b^2})+n^d\frac{a}{b^d}\log^w(\frac{n}{b})+n^d\log^wn\\
    &=a^3T(\frac{n}{b^3})+n^d((\frac{a}{b^d})^2\log^w\frac{n}{b^2}+\frac{a}{b^d}\log^w(\frac{n}{b})+\log^wn)\\
    &=\dots\\
    &=a^{\log_bn}T(1)+n^d\sum_{i=0}^{(\log_bn)-1}(\frac{a}{b^d})^i\log^w{\frac{n}{b^i}}
\end{align}
Since $T(n)=1$ for $n<b$, $T(1)=1$. So 
\begin{align}
    T(n)&=n^{\log_ba}+n^d\sum_{i=0}^{(\log_bn)-1}(\frac{a}{b^d})^i\log^w{\frac{n}{b^i}}
\end{align}
And since $w\geq0$, $b>1$, it is obvious that $\log^w\frac{n}{b^i}\leq\log^wn$. So \\
\begin{align}
    T(n)&\leq n^{\log_ba}+n^d\log^wn\sum_{i=0}^{(\log_bn)-1}(\frac{a}{b^d})^i
\end{align}
If $a<b^d$, then $\sum_{i=0}^{\log_bn-1}(\frac{a}{b^d})^i=O(1)$, so
\begin{align}
    T(n)&\leq n^{\log_ba}+n^d\log^wnO(1)\\
    T(n)&\leq n^{\log_ba}+O(n^d\log^wn)\\
    T(n)&=O(n^d\log^wn)
\end{align}
If $a=b^d$, then $\sum_{i=0}^{\log_bn-1}(\frac{a}{b^d})^i=\log_bn$, so
\begin{align}
    T(n)&\leq n^d+n^d\log^wn\log_bn\\
    T(n)&\leq n^d+n^d\log^wn\frac{\log n}{\log b}\\
    T(n)&\leq n^d+n^d\log^{w+1}n/\log b\\
    T(n)&=O(n^d\log^{w+1}n)
\end{align}
If $a>b^d$, note that by our assumption that $n=b^{2k}$ for some $k\in\mathbb{N}$, $\log_{b}\sqrt{n}$ is an integer. Then 
\begin{align}
    \sum_{i=0}^{(\log_bn)-1}(\frac{a}{b^d})^i\log^w{\frac{n}{b^i}}&=\sum_{i=0}^{\log_{b}\sqrt{n}-1}(\frac{a}{b^d})^i\log^w\frac{n}{b^i}+\sum_{i=\log_{b}\sqrt{n}}^{\log_{b}n-1}(\frac{a}{b^d})^i\log^w\frac{n}{b^i}\\
    &\leq \sum_{i=0}^{\log_{b}\sqrt{n}-1}(\frac{a}{b^d})^i\log^wn+\sum_{i=\log_{b}\sqrt{n}}^{\log_{b}n-1}(\frac{a}{b^d})^i\log^w\sqrt{n}\\
    &\leq O((\frac{a}{b^d})^{\log_b{\sqrt{n}}})\log^wn+O((\frac{a}{b^d})^{\log_b{\sqrt{n}}}\log_b\sqrt{n})\log^w\sqrt{n} \\
    &\leq O(\frac{\sqrt{n}^{\log_ba}}{\sqrt{n}^{d}})\log^wn+O(\frac{\sqrt{n}^{\log_ba}}{\sqrt{n}^{d}}\log_b\sqrt{n})\log^w\sqrt{n}
\end{align}
So
\begin{align}
    T(n)&\leq n^{\log_ba}+n^d\left[O(\frac{\sqrt{n}^{\log_ba}}{\sqrt{n}^{d}})\log^wn+O(\frac{\sqrt{n}^{\log_ba}}{\sqrt{n}^{d}}\log_b\sqrt{n})\log^w\sqrt{n}\right]\\
    &\leq n^{\log_ba}+O(n^{\frac{\log_ba+d}{2}})\left(\log^wn+\log_b\sqrt{n}\log^w\sqrt{n}\right)
\end{align}
Since $a>b^d$
\begin{align}
    T(n)&\leq n^{\log_ba} \\
    T(n)&=O(n^{\log_ba})
\end{align}
\section{}
\subsection{Algorithm Description}
\begin{algorithm}
    \caption{The One Third Merge Sort}\label{alg:13merge}
    \begin{algorithmic}[1]
    \Procedure{OneThirdMergeSort}{$a[1,\dots,n]$}:
    \If{n=1}
    \State {\textbf{return} a}
    \EndIf
    \State $b\gets OneThirdMergeSort(a[1,\dots,\lceil\frac{n}{3}\rceil])$
    \State $c\gets OneThirdMergeSort(a[\lceil\frac{n}{3}\rceil+1,\dots,n])$
    \State \textbf{return} $Merge(b,c)$\Comment{The Merge function is what we have defined in class}
    \EndProcedure
    \end{algorithmic}
\end{algorithm}
Here the Merge function is the same as what we have learnt in class, so I do not write it again.
\subsection{Time Complexity Analysis}
As we have learnt in class, the Merge function is $O(n)$. We have
\begin{align}
    T(n)&=T(\frac{2}{3}n)+T(\frac{1}{3}n)+O(n)\\
    &\leq T(\frac{2}{3}n)+T(\frac{1}{3}n)+cn\quad \text{for some c}\\
    &\leq T(\frac{4n}{3^2})+2T(\frac{2n}{3^2})+T(\frac{n}{3^2})+2cn\\
    &\leq\dots\\
    &\leq \sum_{k=0}^m C_{m}^{k}T(\frac{2^k}{3^m}n)+cmn
\end{align}
When $m=\lceil\log_{\frac{3}{2}}n\rceil$, we have 
\begin{align}
    T(n)&\leq \sum_{k=0}^m C_{m}^{k}T(\frac{2^k}{3^m}n)+cn\log_{\frac{3}{2}}n
\end{align} 
Note that there are at most $n$ elements in our array, hence the term $\sum_{k=0}^m C_{m}^{k}T(\frac{2^k}{3^m}n)$ consists of $n$ terms at most. So when $m=\lceil\log_{\frac{3}{2}}n\rceil$,
\begin{align}
    \sum_{k=0}^m C_{m}^{k}T(\frac{2^k}{3^m}n)&\leq nT(1)
\end{align}  
So
\begin{align}
    T(n)&\leq nT(1)+cn\log_{\frac{3}{2}}n \\
    T(n)&=O(n)+O(n\log_{\frac{3}{2}}n)\\
    T(n)&=O(n\log n)
\end{align}

\section{}

\section{}
\subsection{}
Since $x$ is the median of $\frac{n}{3}$ numbers and the numbers are distinctive to each other, there are exactly $\frac{n}{6}$ numbers smaller than $x$ and exactly $\frac{n}{6}$ numbers larger than $x$ for the same reason. Because those numbers are also medians of each group, exactly another number is smaller(larger) than each of them in their groups respectively. So totally there are $\frac{n}{6}*2=\frac{n}{3}$ numbers in $a$ smaller than $x$ and $\frac{n}{3}$ numbers in $a$ larger than $x$ as well. 
\subsection{}
\subsubsection{Algorithm Design}
\begin{algorithm}
    \caption{The One Third Merge Sort}\label{alg:mofm}
    \begin{algorithmic}[1]
    \Procedure{OneThirdMergeSort}{$a[1,\dots,n]$}:
    \If{n=1}
    \State {\textbf{return} a}
    \EndIf
    \State $b\gets OneThirdMergeSort(a[1,\dots,\lceil\frac{n}{3}\rceil])$
    \State $c\gets OneThirdMergeSort(a[\lceil\frac{n}{3}\rceil+1,\dots,n])$
    \State \textbf{return} $Merge(b,c)$\Comment{The Merge function is what we have defined in class}
    \EndProcedure
    \end{algorithmic}
\end{algorithm}
\subsubsection{Time Complexity Analysis}
Suppose we line up elements in groups of $k$, $k\in\mathbb{N},k\geq 2$. Then by our analysis in part 4.1 we can see there are $\frac{n}{k}$ groups and hence $\frac{n}{2k}$ groups contain $\frac{k+1}{2}$ elements larger(smaller) than the median we calculated. Then after each iteration we can discard at least $n-\frac{n}{2k}\frac{k+1}{2}$ elements and reduce our problem to a same problem with scale $\frac{3k-1}{4k}n$. Hence the Time Complexity can be expressed as 
\begin{align}
    T(n)&=T(\frac{1}{k}n)+T(\frac{3k-1}{4k}n)+\frac{n}{k}O(1)
\end{align}
If $k$ is not so large that the time of finding the medians of $k$ elements can not be treated as a constant, we can safely say 
\begin{align}
    T(n)&\leq T(\frac{1}{k}n)+T(\frac{3k-1}{4k}n)+c\frac{n}{k} \quad \text{for some c}
\end{align}
Now we discuss the Time Complexity with different values of $k$.\\
If $k\geq 4$, then $\frac{1}{k}+\frac{3k-1}{4k}=\frac{3k+3}{4k}<1$. Assume $T(n)\leq\alpha n$ for some $\alpha>0$, it is easy to see that is true when $n=1$. Suppose that is true for $T(\frac{1}{k}n)$ and $T(\frac{3k-1}{4k}n)$, then 
\begin{align}
    T(n)&\leq \alpha\left(\frac{1}{k}+\frac{3k-1}{4k}\right)n+c\frac{n}{k}
\end{align} 
With an $\alpha$ large enough
\begin{align}
    T(n)&\leq \alpha n
\end{align}
So $T(n)=O(n)$ with $k\geq 4$ and $k$ not too large. \\
If $k\leq 3$, then $\frac{1}{k}+\frac{3k-1}{4k}=\frac{3k+3}{4k}>1$. \\
Specifically, with $k=3$
\begin{align}
    T(n)&=T(\frac{1}{3}n)+T(\frac{2}{3}n)+O(\frac{n}{3})
\end{align}
With analysis same as problem 2, we can say $T(n)=O(n\log n)$ with $k=3$. Which means that when $k$ is too small we cannot get an algorithm with speed of linearity.\\
With $k=2$
\begin{align}
    T(n)&=T(\frac{1}{2}n)+T(\frac{5}{8}n)+O(\frac{n}{2})
\end{align}
Similarly we can get $T(n)=O(n\log_{\frac{8}{5}}n)=O(n\log n)$ where it is also not linearity.\\
To sum up, 
    $T(n)=$
$$\begin{cases}
    x_1=ln(-\lambda)\\
    x_2=\frac{1}{2}ln(-\frac{\lambda}{2})\\
    x_3=\frac{1}{2}ln(-\frac{\lambda}{2})\\
\end{cases}$$
\section{}
\subsection*{Acknowledgements}
When proving the case where $a>b^d$ of problem 1, I got the idea of dividing the whole sequence into two parts and analyze them separatly from Liyuan MAO. He illustrate the basic ideas for me and I then wrote a formal proof myself.

\end{document}

